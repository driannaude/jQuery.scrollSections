/*! jQuery ScrollSections Plugin (minified)
* @version 0.5.1
* @link https://github.com/driannaude/jQuery.scrollSections
* @author Drian Naude <https://naude.io/>
* @author 
* @license MIT
* @copyright (c) 2011-2013, Stéphane Guigné
*/
!function(a,b,c,d){"use strict";function e(a){this.name="ScrollSectionsException",this.message=a}var f="scrollSections",g={attr:"id",active:"active-scrollsection",keyboard:!0,mousewheel:!0,touch:!0,scrollbar:!0,navigation:!0,scrollMax:1,before:null,after:null,prefix:"scrollsections",alwaysStartWithFirstSection:!1,animateScrollToFirstSection:!1,createNavigation:!0,inSectionScroll:!0,speed:500,exceptions:!1},h=function(c,d){this.elements=c,this.options=a.extend({},g,d),this._defaults=g,this._name=f,this._$window=a(b),this._$htmlBody=a("html, body"),this._$body=a("body"),this._sections=c.length,this._$sections=[],this._sectionIdentifiers=[],this._delayFirstScroll=null,this._$previousSection=null,this._$currentSection=null,this._currentStep=0,this._isFirstSection=!0,this._isAnimated=!1,this._wheelDelay=null,this._scrollPaused=!1,this._scrollDiff=114,this._$nav=null,this._ltIE9=!1,this.init()};h.prototype={createNavigation:function(){if(this.options.navigation){this._$nav=a("<nav>",{id:this.options.prefix+"-navigation"});for(var b=0;b<this._sections;b++)this._$nav.append(a("<a>",{id:this.options.prefix+"-menuitem-"+b,"class":this.options.prefix+"-menuitem",href:"#"+this._sectionIdentifiers[b],html:"Section "+b}));this._$body.append(this._$nav)}return this},navigation:function(){var b=this;return null===this._$nav&&(this.options.createNavigation?(this.createNavigation(),this.options.createNavigation=!1,this._$nav._$menuitems=a("a",this._$nav).each(function(c){var d=a(this);c===b._currentStep&&d.addClass(b.options.active),d.data(b.options.prefix,c)})):(this._$nav=a("#"+this.options.prefix+"-navigation"),this._$nav._$menuitems=a("a",this._$nav).each(function(){var c=a(this),d=b._sectionIdentifiers.indexOf(c.attr("href").substr(1));d===b._currentStep&&c.addClass(b.options.active),c.data(b.options.prefix,d)}))),null!=this._$nav&&this._$nav.length>0&&this._$nav._$menuitems.click(function(c){var d=a(this),f=parseInt(d.data(b.options.prefix),10);if(c.preventDefault(),b._$nav._$menuitems.removeClass(b.options.active),d.addClass(b.options.active),f>=0)b.customScrollTo(parseInt(d.data(b.options.prefix),10));else if(b.options.exceptions)throw new e("Section not find for this menu item, make sure the href is the same as the section id");return!1}),this},scrollbar:function(){var b=this;if(!a.event.special.scrollstop){if(this.options.exceptions)throw new e("The jQuery special events scrollstop plugin is missing.");return this}return this._$window.bind("scrollstop",function(a){var d,e,f=b._$htmlBody.scrollTop()||b._$window.scrollTop(),g=b._$htmlBody.outerHeight();if(b._scrollPaused=!1,0===f&&0!==b._currentStep)d=0;else if(f===(b._sections-1)*b._$window.height()&&b._currentStep!==b._sections-1)d=b._sections-1;else for(var h=0;h<b._sections;h++)if(e=c.abs(f-b._$sections[h].offset().top),(!g||g>=e)&&(g=e,d=h,0===g))return;b._currentStep!=d&&d>-1&&b.customScrollTo(d)}),this},touch:function(){var a=this;return this._$body.bind("touchstart",function(b){b.originalEvent.touches[0];return b.preventDefault(),a._$body.unbind("touchmove.scrollSections").bind("touchmove.scrollSections",function(b){var d;b.originalEvent.touches[0];return b.preventDefault(),(diff.y<=-100||diff.y>=100)&&c.abs(diff.y)>c.abs(diff.x)&&(d=diff.y<0?a._currentStep-1:a._currentStep+1,a.customScrollTo(d),a._$body.unbind("touchmove.scrollSections")),!1}),!1}),this},keyboard:function(){var a=this;return this._$htmlBody.keydown(function(b){var c;switch(b.which){case 33:case 36:return b.preventDefault(),a.customScrollTo(0),!1;case 34:case 35:return b.preventDefault(),a.customScrollTo(a._sections-1),!1;case 38:return b.preventDefault(),c=a._currentStep-1,c>=0&&a.customScrollTo(c),!1;case 40:return b.preventDefault(),c=a._currentStep+1,c<a._sections&&a.customScrollTo(c),!1}}),this},scrollCallback:function(a){return this._isAnimated=a||!1,a&&this.options.before?this.options.before(this._$previousSection,this._$currentSection):!a&&this.options.after&&this.options.after(this._$currentSection,this._$previousSection),this},customScrollTo:function(b,c){var d,e,f=this;return null!=b&&b>=0&&b<this._sections&&(this._$previousSection=this._$currentSection,this._$currentSection=this._$sections[b],d=b<f._currentStep?this._$currentSection.offset().top+this._$currentSection.height()-f._$htmlBody.outerHeight():this._$currentSection.offset().top,this._currentStep=b,e=c?0:this.options.speed,this._$nav&&(this._$nav._$menuitems.removeClass(this.options.active),a('a[href="#'+this._sectionIdentifiers[b]+'"]',this._$nav).addClass(this.options.active)),this.scrollCallback(!0),a.when(this._$htmlBody.stop(!0,!1).animate({scrollTop:d},e)).done(function(){f.scrollCallback()})),this},mousewheelScrollTo:function(a){return this.customScrollTo(a),this._wheelDelay=null,this._scrollPaused=!0,this},mousewheel:function(){var b=this;if(this._ltIE9){if(this.options.exceptions)throw new e("Cannot bind mousewheel on broken client.");return this}if(!a.fn.mousewheel){if(this.options.exceptions)throw new e("The jQuery mousewheel plugin is missing.");return this}var d=(new Date).getTime();return this._$window.mousewheel(function(a,e,f,g){var h=(new Date).getTime(),i=!1;if("undefined"!=typeof d){var j=h-d;j>50&&(i=!0)}d=h;var k=b._$htmlBody.scrollTop()||b._$window.scrollTop(),l=null,m=-1;return(!b._isAnimated||!b._scrollPaused)&&i&&(g>>=0,0>g?b._currentStep+1<b._sections&&(g<-b.options.scrollMax&&(g=-b.options.scrollMax),b.options.inSectionScroll&&k+b._$htmlBody.outerHeight()-g*b._scrollDiff>b._$sections[b._currentStep+1].offset().top?(m=b._currentStep+1,l=!0):!b.options.inSectionScroll&&(!m||!l||l>g)&&b._currentStep-g<b._sections&&(l=g,m=b._currentStep-l)):b._currentStep>0&&(g>b.options.scrollMax&&(g=b.options.scrollMax),b.options.inSectionScroll&&k-g*b._scrollDiff<b._$sections[b._currentStep].offset().top?(m=b._currentStep-1,l=!0):!b.options.inSectionScroll&&(!m||!l||g>l)&&b._currentStep-g>-1&&(l=g,m=b._currentStep-l)),l&&m>-1)?(a.preventDefault(),b._wheelDelay&&clearTimeout(b._wheelDelay),c.abs(l)<b.options.scrollMax?b._wheelDelay=setTimeout(function(){b.mousewheelScrollTo(m)},10):b.mousewheelScrollTo(m),!1):void 0}),this},init:function(){var c=this;if(this._sections>0){this.elements.each(function(b){var d,e=a(this),f=c._$window.scrollTop();c._$sections[b]=e,c._sectionIdentifiers[b]=e.attr(c.options.attr),c.options.alwaysStartWithFirstSection===!0&&0===b?(e.addClass(c.options.active),c._$currentSection=e,c.customScrollTo(0,!c.options.animateScrollToFirstSection)):(d=e.offset(),d.bottom=d.top+e.height(),f>=d.top&&f<d.bottom&&(e.addClass(c.options.active),c._currentStep=b,c._$currentSection=e,f!==d.top&&c.customScrollTo(b)))}),new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})").exec(b.navigator.userAgent)&&parseFloat(RegExp.$1)<=8&&(this._ltIE9=!0);for(var d in this.options)this.options[d]===!0&&"function"==typeof this[d]&&this[d]();this._$window.resize(function(){c.customScrollTo(c._currentStep)})}return this}},a.fn[f]=function(b){return a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new h(this,b)),this}}(jQuery,window,Math);